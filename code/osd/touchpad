#!/usr/bin/env bash

TOUCHPAD_DEVICE="elan1300:00-04f3:3087-touchpad"

# Set up XDG_RUNTIME_DIR if not set
if [ "$XDG_RUNTIME_DIR" = "" ]; then
    export XDG_RUNTIME_DIR=/run/user/$(id -u)
fi

STATUS_FILE="$XDG_RUNTIME_DIR/touchpad.status"

# Function to enable touchpad
enable_touchpad() {
    printf "true" > "$STATUS_FILE"
    hyprctl keyword "device[$TOUCHPAD_DEVICE]:enabled" true
}

# Function to disable touchpad
disable_touchpad() {
    printf "false" > "$STATUS_FILE"
    hyprctl keyword "device[$TOUCHPAD_DEVICE]:enabled" false
}

# Function to toggle touchpad
toggle_touchpad() {
    if ! [ -f "$STATUS_FILE" ]; then
        disable_touchpad
    else
        if [ "$(cat "$STATUS_FILE")" = "true" ]; then
            disable_touchpad
        elif [ "$(cat "$STATUS_FILE")" = "false" ]; then
            enable_touchpad
        fi
    fi
}

# Main logic: toggle touchpad and show OSD via AGS
toggle_touchpad

if [ -f "$STATUS_FILE" ] && [ "$(cat "$STATUS_FILE")" = "true" ]; then
    ags request osd touchpad on >/dev/null 2>&1 || true
else
    ags request osd touchpad off >/dev/null 2>&1 || true
fi
