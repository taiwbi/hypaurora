#!/bin/bash

# Destination directory
destination_dir="$HOME/Pictures/background"
destination_file="$destination_dir/background.png"

# Check if image is dark or light itself:
identify -verbose background-dark.png

# Check if ffmpeg is installed
if ! command -v ffmpeg &>/dev/null; then
	notify-send "Error" "ffmpeg is not installed. Please install ffmpeg."
	exit 1
fi

ffmpeg -i "$1" -vf "scale='if(gt(a,16/9),-1,1920)':'if(gt(a,16/9),1080,-1)',crop=1920:1080" -qscale:v 2 "$destination_file" -y
ffmpeg -i "$destination_file" -vf "crop=iw-42:ih-2:41:1,boxblur=20:20" "$destination_dir/background-jb.png" -y
ffmpeg -i "$destination_file" -vf "crop=iw-42:ih-2:41:1" "$destination_dir/background-jb-solid.png" -y

pkill hyprpaper
hyprpaper
